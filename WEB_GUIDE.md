# Web界面使用指南

## 访问地址

启动程序后，在浏览器中访问：**http://localhost:8080**

## 界面功能说明

### 📝 功能一：生成模板

<img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300'%3E%3Crect fill='%234F46E5' width='400' height='300' rx='10'/%3E%3Ctext x='200' y='150' fill='white' font-size='24' text-anchor='middle'%3E生成模板区域%3C/text%3E%3C/svg%3E" width="200" alt="生成模板">

**操作步骤：**
1. 在"生成模板"卡片中选择需要生成的月份
2. 点击"生成模板"按钮
3. 等待提示"模板生成成功"
4. 打开 `data` 目录查看生成的Excel文件

**注意事项：**
- 默认选中当前月份
- 已存在的文件不会覆盖已填写的数据
- 文件名格式：`attendance_YYYY-MM.xlsx`

---

### ✏️ 功能二：填写数据

<img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300'%3E%3Crect fill='%2310B981' width='400' height='300' rx='10'/%3E%3Ctext x='200' y='150' fill='white' font-size='24' text-anchor='middle'%3E填写数据说明%3C/text%3E%3C/svg%3E" width="200" alt="填写数据">

**操作步骤：**
1. 打开 `data` 目录下生成的Excel文件
2. 在"上班时间"列填写时间，格式：`08:56`
3. 在"下班时间"列填写时间，格式：`18:30`
4. 保存Excel文件

**填写示例：**
```
日期         星期    上班时间  下班时间  备注
2025-10-01  星期三   08:56    18:30
2025-10-02  星期四   09:05    19:20    加班
2025-10-03  星期五   08:50    18:00
2025-10-04  星期六                     周末休息
2025-10-05  星期日                     周末休息
```

**时间格式要求：**
- ✅ 正确：`08:56`、`9:05`、`18:30`
- ❌ 错误：`8:56:00`、`08-56`、`8点56分`

---

### 🔢 功能三：计算工时

<img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300'%3E%3Crect fill='%238B5CF6' width='400' height='300' rx='10'/%3E%3Ctext x='200' y='150' fill='white' font-size='24' text-anchor='middle'%3E计算工时区域%3C/text%3E%3C/svg%3E" width="200" alt="计算工时">

**操作步骤：**
1. 在"计算工时"卡片中选择月份
2. 点击"计算工时"按钮
3. 页面自动滚动到统计报告区域
4. 查看详细的工时统计数据

**统计报告包含：**
- 📊 **当月总工时**：本月累计工作时长
- 📅 **出勤天数**：实际上班天数
- ⏱️ **日平均工时**：出勤日的平均工作时长
- 🎯 **期望目标**：设定的目标工时（默认220小时）
- 📈 **距离目标**：还需工作的时长
- 📆 **剩余工作日**：本月剩余的工作日天数
- 💪 **需要日均工时**：为达到目标，剩余工作日需要的平均工时
- 🏖️ **请假统计**：请假天数和总时长

---

## 完整使用流程

### 场景：管理2025年10月的考勤工时

1. **启动程序**
   - 在IDEA中运行 `TimeCountApplication`
   - 等待启动完成

2. **打开Web界面**
   - 浏览器访问：http://localhost:8080
   - 看到美观的界面

3. **生成考勤模板**
   - 在"生成模板"卡片选择 `2025-10`
   - 点击"生成模板"按钮
   - 等待提示成功

4. **填写考勤数据**
   - 打开 `data/attendance_2025-10.xlsx`
   - 填写每天的上下班时间
   - 保存文件

5. **计算工时统计**
   - 返回Web界面
   - 在"计算工时"卡片选择 `2025-10`
   - 点击"计算工时"按钮
   - 查看详细报告

6. **查看统计结果**
   - 页面显示完整的工时统计报告
   - 包含总工时、平均工时、请假统计等
   - 可以根据数据调整工作安排

---

## 工时计算规则说明

### 基本计算公式
```
工时 = 下班时间 - 上班时间 - 午休时间 - 晚餐时间（如适用）
```

### 午休时间扣除
- **所有情况**扣除 **1小时** 午休时间

### 晚餐时间扣除
- 下班时间 **< 19:00**：不扣除晚餐时间
- 下班时间 **≥ 19:00**：扣除 **0.5小时** 晚餐时间

### 计算示例

**示例1：正常上班**
- 上班：08:56
- 下班：18:30
- 计算：18:30 - 08:56 - 1小时（午休）= 8.57小时

**示例2：加班到晚**
- 上班：09:00
- 下班：19:30
- 计算：19:30 - 09:00 - 1小时（午休）- 0.5小时（晚餐）= 9小时

**示例3：早退**
- 上班：09:00
- 下班：17:30
- 计算：17:30 - 09:00 - 1小时（午休）= 7.5小时
- 状态：视为早退/请假

---

## 请假判定规则

对于**当前时间之前的工作日**，满足以下任一条件视为请假：

### 1. 缺勤（全天请假）
- 上下班时间均为空
- 请假时长：8小时

### 2. 迟到
- 上班时间 **> 09:00**
- 请假时长：按实际差值计算

### 3. 早退
- 下班时间 **< 18:00**
- 请假时长：按实际差值计算

### 请假示例

**示例1：全天缺勤**
- 上班：（空）
- 下班：（空）
- 结果：请假 8小时

**示例2：迟到早退**
- 上班：10:00（迟到1小时）
- 下班：17:00（早退1小时）
- 实际工时：6小时
- 请假时长：2小时

---

## 界面特色功能

### 🎨 美观的UI设计
- 渐变背景色
- 卡片式布局
- 现代化配色方案

### ⚡ 动画效果
- 页面加载淡入效果
- 按钮hover悬停效果
- 平滑滚动过渡

### 📱 响应式布局
- 自适应不同屏幕尺寸
- 移动端友好
- 平板电脑优化

### 🔔 实时反馈
- 操作成功/失败提示
- 加载中状态显示
- 错误信息提示

---

## 常见问题

### Q1: 点击按钮没有反应？
**A:** 检查以下几点：
- 确认程序已启动
- 检查浏览器控制台是否有错误
- 尝试刷新页面
- 确认选择了月份

### Q2: 提示"考勤文件不存在"？
**A:** 需要先生成模板：
1. 点击"生成模板"按钮
2. 等待生成成功
3. 再进行工时计算

### Q3: 工时计算不准确？
**A:** 检查Excel文件：
- 时间格式是否正确（HH:mm）
- 是否有非法字符
- 保存文件后再计算

### Q4: 无法打开Excel文件？
**A:** 确认以下几点：
- `data` 目录是否存在
- 文件权限是否正确
- 是否安装了Excel或WPS

### Q5: 页面显示不正常？
**A:** 尝试以下方法：
- 使用现代浏览器（Chrome、Edge、Firefox）
- 清除浏览器缓存
- 检查网络连接（需要加载Tailwind CSS）

---

## 高级技巧

### 批量生成多个月份
```javascript
// 在浏览器控制台执行
const months = ['2025-10', '2025-11', '2025-12'];
for (const month of months) {
    await fetch(`/api/workhours/template/generate?yearMonth=${month}`, {
        method: 'POST'
    });
}
```

### 修改期望总工时
编辑 `application.properties`：
```properties
workhours.expected-total-hours=240.0
```

### 自定义午休/晚餐时间
编辑 `application.properties`：
```properties
workhours.lunch-break-hours=1.5
workhours.dinner-break-hours=1.0
```

---

## 快捷键（计划中）

- `Ctrl + G`：快速生成模板
- `Ctrl + C`：快速计算工时
- `Esc`：关闭报告

---

## 技术支持

如有问题，请查看：
- 项目 README.md
- QUICK_START.md
- 或提交Issue

---

**享受高效的工时管理！** 🎉
